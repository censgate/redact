# UK GDPR (Post-Brexit) Compliance Patterns
# Public Domain Pattern Library for UK Data Protection Act 2018
version: "1.0"
framework: "UK-GDPR"
jurisdiction: "United Kingdom"
description: "Patterns for detecting personal data under UK GDPR and Data Protection Act 2018"
last_updated: "2024-01-15"

patterns:
  # Personal Identifiers
  - id: "uk_ni_number"
    name: "National Insurance Number"
    category: "personal_identifier"
    regex: '\b[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}[0-9]{6}[A-D]{1}\b'
    confidence: 0.95
    description: "Detects UK National Insurance Numbers"
    examples:
      - "QQ123456C"
      - "AB123456D"
    replacement: "[NI_NUMBER_REDACTED]"
    enabled: true

  - id: "uk_nhs_number"
    name: "NHS Number"
    category: "health"
    regex: '\b[0-9]{3}\s?[0-9]{3}\s?[0-9]{4}\b'
    confidence: 0.9
    description: "Detects NHS numbers"
    examples:
      - "123 456 7890"
      - "1234567890"
    replacement: "[NHS_NUMBER_REDACTED]"
    enabled: true

  - id: "uk_passport"
    name: "UK Passport Number"
    category: "personal_identifier"
    regex: '\b[0-9]{9}\b'
    confidence: 0.8
    description: "Detects UK passport numbers"
    examples:
      - "123456789"
      - "987654321"
    replacement: "[PASSPORT_REDACTED]"
    enabled: true

  - id: "uk_driving_licence"
    name: "UK Driving Licence"
    category: "personal_identifier"
    regex: '\b[A-Z9]{5}\d{6}[A-Z9]{2}\d[A-Z]{2}\b'
    confidence: 0.9
    description: "Detects UK driving licence numbers"
    examples:
      - "MORGA657054SM9IJ"
      - "SMITH123456AB7CD"
    replacement: "[DRIVING_LICENCE_REDACTED]"
    enabled: true

  # Contact Information
  - id: "uk_email"
    name: "Email Address"
    category: "contact_info"
    regex: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
    confidence: 0.95
    description: "Detects email addresses"
    examples:
      - "user@example.co.uk"
      - "john.doe@company.com"
    replacement: "[EMAIL_REDACTED]"
    enabled: true

  - id: "uk_phone"
    name: "UK Phone Number"
    category: "contact_info"
    regex: '\b(?:\+44\s?|0)(?:[1-9]\d{8,9}|[1-9]\d\s?\d{3}\s?\d{4})\b'
    confidence: 0.9
    description: "Detects UK phone numbers"
    examples:
      - "+44 20 7946 0958"
      - "020 7946 0958"
      - "07700 900123"
    replacement: "[PHONE_REDACTED]"
    enabled: true

  # Financial Information
  - id: "uk_sort_code"
    name: "UK Sort Code"
    category: "financial"
    regex: '\b\d{2}-\d{2}-\d{2}\b'
    confidence: 0.9
    description: "Detects UK bank sort codes"
    examples:
      - "12-34-56"
      - "98-76-54"
    replacement: "[SORT_CODE_REDACTED]"
    enabled: true

  - id: "uk_account_number"
    name: "UK Bank Account Number"
    category: "financial"
    regex: '\b\d{8}\b'
    confidence: 0.8
    description: "Detects UK bank account numbers"
    examples:
      - "12345678"
      - "87654321"
    replacement: "[ACCOUNT_REDACTED]"
    enabled: true

  - id: "uk_iban"
    name: "UK IBAN"
    category: "financial"
    regex: '\bGB\d{2}[A-Z]{4}\d{14}\b'
    confidence: 0.95
    description: "Detects UK International Bank Account Numbers"
    examples:
      - "GB82WEST12345698765432"
      - "GB29NWBK60161331926819"
    replacement: "[IBAN_REDACTED]"
    enabled: true

  # Location Data
  - id: "uk_postcode"
    name: "UK Postcode"
    category: "location"
    regex: '\b[A-Z]{1,2}\d[A-Z\d]?\s?\d[A-Z]{2}\b'
    confidence: 0.9
    description: "Detects UK postcodes"
    examples:
      - "SW1A 1AA"
      - "M1 1AA"
      - "B33 8TH"
    replacement: "[POSTCODE_REDACTED]"
    enabled: true

  - id: "uk_address"
    name: "UK Address"
    category: "location"
    regex: '\b\d+\s+[A-Za-z0-9\s]+(?:Street|St|Road|Rd|Avenue|Ave|Lane|Ln|Drive|Dr|Close|Cl|Court|Ct|Place|Pl|Way|Crescent|Cres|Gardens|Gdns)\b'
    confidence: 0.8
    description: "Detects UK street addresses"
    examples:
      - "10 Downing Street"
      - "221B Baker Street"
      - "1 Abbey Road"
    replacement: "[ADDRESS_REDACTED]"
    enabled: true

  # Professional Information
  - id: "uk_vat_number"
    name: "UK VAT Number"
    category: "professional"
    regex: '\bGB\d{9}(?:\d{3})?\b'
    confidence: 0.9
    description: "Detects UK VAT registration numbers"
    examples:
      - "GB123456789"
      - "GB123456789012"
    replacement: "[VAT_NUMBER_REDACTED]"
    enabled: true

  - id: "uk_company_number"
    name: "UK Company Registration Number"
    category: "professional"
    regex: '\b(?:Company No\.?|Registration No\.?|Reg\.? No\.?)[:\s]*(\d{8})\b'
    confidence: 0.85
    description: "Detects UK company registration numbers"
    examples:
      - "Company No: 12345678"
      - "Registration No. 87654321"
    replacement: "[COMPANY_NUMBER_REDACTED]"
    enabled: true

  # Network and Electronic
  - id: "uk_ip_address"
    name: "IP Address"
    category: "network"
    regex: '\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'
    confidence: 0.9
    description: "Detects IPv4 addresses"
    examples:
      - "192.168.1.1"
      - "10.0.0.1"
    replacement: "[IP_REDACTED]"
    enabled: true

  - id: "uk_mac_address"
    name: "MAC Address"
    category: "network"
    regex: '\b([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})\b'
    confidence: 0.95
    description: "Detects MAC addresses"
    examples:
      - "00:1B:44:11:3A:B7"
      - "00-1B-44-11-3A-B7"
    replacement: "[MAC_REDACTED]"
    enabled: true

metadata:
  compliance_frameworks:
    - "UK-GDPR"
    - "DPA-2018"
    - "PECR"
  categories:
    - "personal_identifier"
    - "health"
    - "contact_info"
    - "financial"
    - "location"
    - "professional"
    - "network"
  risk_levels:
    high: ["uk_ni_number", "uk_nhs_number", "uk_passport", "uk_driving_licence"]
    medium: ["uk_email", "uk_phone", "uk_iban", "uk_sort_code", "uk_account_number"]
    low: ["uk_postcode", "uk_vat_number", "uk_ip_address", "uk_mac_address"]
  validation:
    pattern_count: 14
    categories_covered: 7
    compliance_score: 0.96
