# California Consumer Privacy Act (CCPA) Compliance Patterns
# Public Domain Pattern Library for CCPA Compliance
version: "1.0"
framework: "US-CCPA"
jurisdiction: "California, United States"
description: "Patterns for detecting personal information under California Consumer Privacy Act"
last_updated: "2024-01-15"

patterns:
  # Personal Identifiers
  - id: "ccpa_ssn"
    name: "Social Security Number"
    category: "personal_identifier"
    regex: '\b\d{3}-?\d{2}-?\d{4}\b'
    confidence: 0.9
    description: "Detects Social Security Numbers in various formats"
    examples:
      - "123-45-6789"
      - "123456789"
      - "123 45 6789"
    replacement: "[SSN_REDACTED]"
    enabled: true

  - id: "ccpa_drivers_license"
    name: "California Driver's License"
    category: "personal_identifier"
    regex: '\b[A-Z]\d{7}\b'
    confidence: 0.85
    description: "Detects California driver's license numbers"
    examples:
      - "A1234567"
      - "B9876543"
    replacement: "[DL_REDACTED]"
    enabled: true

  - id: "ccpa_email"
    name: "Email Address"
    category: "contact_info"
    regex: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
    confidence: 0.95
    description: "Detects email addresses"
    examples:
      - "user@example.com"
      - "john.doe@company.org"
    replacement: "[EMAIL_REDACTED]"
    enabled: true

  - id: "ccpa_phone"
    name: "Phone Number"
    category: "contact_info"
    regex: '\b(?:\+1[-.\s]?)?\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})\b'
    confidence: 0.9
    description: "Detects US phone numbers in various formats"
    examples:
      - "(555) 123-4567"
      - "555-123-4567"
      - "555.123.4567"
      - "+1 555 123 4567"
    replacement: "[PHONE_REDACTED]"
    enabled: true

  # Financial Information
  - id: "ccpa_credit_card"
    name: "Credit Card Number"
    category: "financial"
    regex: '\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3[0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\b'
    confidence: 0.92
    description: "Detects major credit card numbers (Visa, MasterCard, Amex, Discover)"
    examples:
      - "4111111111111111"
      - "5555555555554444"
      - "378282246310005"
    replacement: "[CREDIT_CARD_REDACTED]"
    enabled: true

  - id: "ccpa_bank_account"
    name: "Bank Account Number"
    category: "financial"
    regex: '\b\d{8,17}\b'
    confidence: 0.7
    description: "Detects potential bank account numbers"
    examples:
      - "12345678901"
      - "987654321012345"
    replacement: "[ACCOUNT_REDACTED]"
    enabled: true

  # Biometric and Health Information
  - id: "ccpa_medical_record"
    name: "Medical Record Number"
    category: "health"
    regex: '\b(?:MRN|MR|Medical Record)[:\s#]*([A-Z0-9]{6,12})\b'
    confidence: 0.8
    description: "Detects medical record numbers"
    examples:
      - "MRN: ABC123456"
      - "Medical Record #MR789012"
    replacement: "[MEDICAL_RECORD_REDACTED]"
    enabled: true

  # Geographic Location Data
  - id: "ccpa_zip_code"
    name: "ZIP Code"
    category: "location"
    regex: '\b\d{5}(?:-\d{4})?\b'
    confidence: 0.85
    description: "Detects US ZIP codes"
    examples:
      - "90210"
      - "12345-6789"
    replacement: "[ZIP_REDACTED]"
    enabled: true

  - id: "ccpa_address"
    name: "Street Address"
    category: "location"
    regex: '\b\d+\s+[A-Za-z0-9\s]+(?:Street|St|Avenue|Ave|Road|Rd|Boulevard|Blvd|Lane|Ln|Drive|Dr|Court|Ct|Place|Pl)\b'
    confidence: 0.8
    description: "Detects street addresses"
    examples:
      - "123 Main Street"
      - "456 Oak Ave"
      - "789 Pine Rd"
    replacement: "[ADDRESS_REDACTED]"
    enabled: true

  # Internet and Electronic Activity
  - id: "ccpa_ip_address"
    name: "IP Address"
    category: "network"
    regex: '\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'
    confidence: 0.9
    description: "Detects IPv4 addresses"
    examples:
      - "192.168.1.1"
      - "10.0.0.1"
    replacement: "[IP_REDACTED]"
    enabled: true

  - id: "ccpa_mac_address"
    name: "MAC Address"
    category: "network"
    regex: '\b([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})\b'
    confidence: 0.95
    description: "Detects MAC addresses"
    examples:
      - "00:1B:44:11:3A:B7"
      - "00-1B-44-11-3A-B7"
    replacement: "[MAC_REDACTED]"
    enabled: true

  # Professional Information
  - id: "ccpa_employment_info"
    name: "Employment Information"
    category: "professional"
    regex: '\b(?:Employee ID|EID|Badge)[:\s#]*([A-Z0-9]{4,10})\b'
    confidence: 0.75
    description: "Detects employee identification numbers"
    examples:
      - "Employee ID: EMP12345"
      - "Badge #B789012"
    replacement: "[EMPLOYEE_ID_REDACTED]"
    enabled: true

metadata:
  compliance_frameworks:
    - "CCPA"
    - "CPRA"
  categories:
    - "personal_identifier"
    - "contact_info"
    - "financial"
    - "health"
    - "location"
    - "network"
    - "professional"
  risk_levels:
    high: ["ccpa_ssn", "ccpa_credit_card", "ccpa_medical_record"]
    medium: ["ccpa_email", "ccpa_phone", "ccpa_drivers_license", "ccpa_bank_account"]
    low: ["ccpa_zip_code", "ccpa_ip_address", "ccpa_mac_address"]
  validation:
    pattern_count: 11
    categories_covered: 7
    compliance_score: 0.95
