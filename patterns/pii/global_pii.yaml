# Global PII Patterns
# Public Domain Pattern Library for Common Personally Identifiable Information
version: "1.0"
framework: "Global-PII"
jurisdiction: "Global"
description: "Universal patterns for detecting common personally identifiable information"
last_updated: "2024-01-15"

patterns:
  # Names
  - id: "global_full_name"
    name: "Full Name"
    category: "personal_name"
    regex: '\b[A-Z][a-z]{1,20}\s+[A-Z][a-z]{1,20}(?:\s+[A-Z][a-z]{1,20})?\b'
    confidence: 0.7
    description: "Detects full names (first and last, optionally middle)"
    examples:
      - "John Smith"
      - "Mary Jane Watson"
      - "José García"
    replacement: "[NAME_REDACTED]"
    enabled: true

  - id: "global_email"
    name: "Email Address"
    category: "contact"
    regex: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
    confidence: 0.95
    description: "Detects email addresses globally"
    examples:
      - "user@example.com"
      - "john.doe@company.org"
      - "contact@website.co.uk"
    replacement: "[EMAIL_REDACTED]"
    enabled: true

  # International Phone Numbers
  - id: "global_phone_intl"
    name: "International Phone Number"
    category: "contact"
    regex: '\+[1-9]\d{1,14}\b'
    confidence: 0.9
    description: "Detects international phone numbers with country codes"
    examples:
      - "+1234567890"
      - "+442071234567"
      - "+33123456789"
    replacement: "[PHONE_REDACTED]"
    enabled: true

  - id: "global_phone_common"
    name: "Common Phone Formats"
    category: "contact"
    regex: '\b(?:\+?[1-9]\d{0,3}[-.\s]?)?\(?[0-9]{2,4}\)?[-.\s]?[0-9]{2,4}[-.\s]?[0-9]{2,6}\b'
    confidence: 0.8
    description: "Detects common phone number formats"
    examples:
      - "123-456-7890"
      - "(555) 123-4567"
      - "020 7123 4567"
    replacement: "[PHONE_REDACTED]"
    enabled: true

  # Financial Information
  - id: "global_credit_card"
    name: "Credit Card Number"
    category: "financial"
    regex: '\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3[0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\b'
    confidence: 0.92
    description: "Detects major credit card numbers (Visa, MasterCard, Amex, Discover)"
    examples:
      - "4111111111111111"
      - "5555555555554444"
      - "378282246310005"
    replacement: "[CREDIT_CARD_REDACTED]"
    enabled: true

  - id: "global_iban"
    name: "International Bank Account Number"
    category: "financial"
    regex: '\b[A-Z]{2}\d{2}[A-Z0-9]{4}\d{7}([A-Z0-9]?){0,16}\b'
    confidence: 0.9
    description: "Detects IBAN numbers"
    examples:
      - "GB82WEST12345698765432"
      - "DE89370400440532013000"
      - "FR1420041010050500013M02606"
    replacement: "[IBAN_REDACTED]"
    enabled: true

  # Dates
  - id: "global_date_iso"
    name: "ISO Date Format"
    category: "temporal"
    regex: '\b\d{4}-\d{2}-\d{2}\b'
    confidence: 0.9
    description: "Detects ISO date format (YYYY-MM-DD)"
    examples:
      - "1990-01-15"
      - "2023-12-25"
    replacement: "[DATE_REDACTED]"
    enabled: true

  - id: "global_date_common"
    name: "Common Date Formats"
    category: "temporal"
    regex: '\b\d{1,2}[/-]\d{1,2}[/-]\d{2,4}\b'
    confidence: 0.8
    description: "Detects common date formats"
    examples:
      - "01/15/1990"
      - "15-01-1990"
      - "1/15/90"
    replacement: "[DATE_REDACTED]"
    enabled: true

  # Network Identifiers
  - id: "global_ipv4"
    name: "IPv4 Address"
    category: "network"
    regex: '\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'
    confidence: 0.9
    description: "Detects IPv4 addresses"
    examples:
      - "192.168.1.1"
      - "10.0.0.1"
      - "172.16.254.1"
    replacement: "[IP_REDACTED]"
    enabled: true

  - id: "global_ipv6"
    name: "IPv6 Address"
    category: "network"
    regex: '\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b'
    confidence: 0.95
    description: "Detects IPv6 addresses"
    examples:
      - "2001:0db8:85a3:0000:0000:8a2e:0370:7334"
      - "2001:db8:85a3::8a2e:370:7334"
    replacement: "[IPV6_REDACTED]"
    enabled: true

  - id: "global_mac_address"
    name: "MAC Address"
    category: "network"
    regex: '\b([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})\b'
    confidence: 0.95
    description: "Detects MAC addresses"
    examples:
      - "00:1B:44:11:3A:B7"
      - "00-1B-44-11-3A-B7"
      - "001b.4411.3ab7"
    replacement: "[MAC_REDACTED]"
    enabled: true

  # URLs and Domains
  - id: "global_url"
    name: "URL"
    category: "network"
    regex: '\bhttps?://[A-Za-z0-9.-]+(?:/[A-Za-z0-9./_?#-]*)?\b'
    confidence: 0.9
    description: "Detects HTTP and HTTPS URLs"
    examples:
      - "http://example.com"
      - "https://www.example.org/path"
      - "https://subdomain.example.co.uk/page?param=value"
    replacement: "[URL_REDACTED]"
    enabled: true

  - id: "global_domain"
    name: "Domain Name"
    category: "network"
    regex: '\b[A-Za-z0-9.-]+\.[A-Za-z]{2,}\b'
    confidence: 0.7
    description: "Detects domain names"
    examples:
      - "example.com"
      - "subdomain.example.org"
      - "website.co.uk"
    replacement: "[DOMAIN_REDACTED]"
    enabled: true

  # Geographic Information
  - id: "global_coordinates"
    name: "GPS Coordinates"
    category: "location"
    regex: '\b-?\d{1,3}\.\d{1,10},\s?-?\d{1,3}\.\d{1,10}\b'
    confidence: 0.9
    description: "Detects GPS coordinates (latitude, longitude)"
    examples:
      - "40.7128, -74.0060"
      - "51.5074, -0.1278"
      - "-33.8688, 151.2093"
    replacement: "[COORDINATES_REDACTED]"
    enabled: true

  # Generic Identifiers
  - id: "global_uuid"
    name: "UUID"
    category: "identifier"
    regex: '\b[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\b'
    confidence: 0.95
    description: "Detects UUID/GUID identifiers"
    examples:
      - "123e4567-e89b-12d3-a456-426614174000"
      - "550e8400-e29b-41d4-a716-446655440000"
    replacement: "[UUID_REDACTED]"
    enabled: true

  - id: "global_api_key"
    name: "API Key Pattern"
    category: "security"
    regex: '\b(?:api_key|apikey|access_token|secret_key|private_key)["\s:=]+([A-Za-z0-9_-]{20,})\b'
    confidence: 0.85
    description: "Detects common API key patterns"
    examples:
      - 'api_key: "sk_live_abcdef123456789"'
      - "access_token=abc123def456ghi789"
    replacement: "[API_KEY_REDACTED]"
    enabled: true

  # Cryptographic Hashes
  - id: "global_hash_md5"
    name: "MD5 Hash"
    category: "security"
    regex: '\b[a-fA-F0-9]{32}\b'
    confidence: 0.8
    description: "Detects MD5 hashes"
    examples:
      - "5d41402abc4b2a76b9719d911017c592"
      - "098f6bcd4621d373cade4e832627b4f6"
    replacement: "[MD5_HASH_REDACTED]"
    enabled: true

  - id: "global_hash_sha256"
    name: "SHA-256 Hash"
    category: "security"
    regex: '\b[a-fA-F0-9]{64}\b'
    confidence: 0.85
    description: "Detects SHA-256 hashes"
    examples:
      - "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
    replacement: "[SHA256_HASH_REDACTED]"
    enabled: true

metadata:
  compliance_frameworks:
    - "GDPR"
    - "CCPA"
    - "PIPEDA"
    - "Global Privacy Standards"
  categories:
    - "personal_name"
    - "contact"
    - "financial"
    - "temporal"
    - "network"
    - "location"
    - "identifier"
    - "security"
  risk_levels:
    high: ["global_full_name", "global_email", "global_credit_card", "global_iban"]
    medium: ["global_phone_intl", "global_phone_common", "global_coordinates", "global_api_key"]
    low: ["global_date_iso", "global_ipv4", "global_mac_address", "global_uuid", "global_hash_md5"]
  validation:
    pattern_count: 17
    categories_covered: 8
    compliance_score: 0.94
